---
title: "Sheet Eleven Solutions"
format: html
filters:
  - pyodide
---

### Task 3

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)")
ax.plot(x, yp, label="p'(x)")
ax.legend()
plt.show()
```

### Task 4

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

# Inflection point for this cubic is at x = 0.
x0 = 0.0
y0 = p(x0)
slope = dp(x0)

x_tan = np.linspace(x0 - 1.0, x0 + 1.0, 50)
y_tan = y0 + slope * (x_tan - x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)")
ax.plot(x, yp, label="p'(x)")
ax.plot(x_tan, y_tan, label="Tangent at inflection")
ax.legend()
plt.show()
```

### Task 5

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

# Extrema at x = -1 and x = 1.
x1 = -1.0
x2 = 1.0
y1 = p(x1)
y2 = p(x2)

x_tan1 = np.linspace(x1 - 1.0, x1 + 1.0, 50)
x_tan2 = np.linspace(x2 - 1.0, x2 + 1.0, 50)
y_tan1 = y1 + 0.0 * (x_tan1 - x1)
y_tan2 = y2 + 0.0 * (x_tan2 - x2)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)")
ax.plot(x, yp, label="p'(x)")
ax.plot(x_tan1, y_tan1, label="Tangent at x=-1")
ax.plot(x_tan2, y_tan2, label="Tangent at x=1")
ax.legend()
plt.show()
```

### Task 6

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)
slope = dp(x0)
x_tan = np.linspace(x0 - 1.0, x0 + 1.0, 50)
y_tan = y0 + slope * (x_tan - x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)")
ax.plot(x, yp, label="p'(x)")
ax.plot(x_tan, y_tan, color="black", linestyle=":", label="Tangent")
ax.plot(x_tan1, y_tan1,color="black", linestyle=":", label="Tangent at x=-1")
ax.plot(x_tan2, y_tan2, color="black", linestyle=":",label="Tangent at x=1")

ax.legend()
plt.show()
```

### Task 7

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)", linewidth=3)
ax.plot(x, yp, label="p'(x)", linewidth=1)
ax.legend()
plt.show()
```

### Task 8

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)", linewidth=3)
ax.plot(x, yp, label="p'(x)", linewidth=1)

 # Inflection point
ax.scatter([x0], [y0])
ax.annotate(
    "Inflection",
    xy=(x0, y0),
)
# Extrema
x1, x2 = -1.0, 1.0
y1, y2 = p(x1), p(x2)

ax.scatter([x1, x2], [y1, y2])
ax.annotate(
    "Local max",
    xy=(x1, y1),
)
ax.annotate(
    "Local min",
    xy=(x2, y2),
)

ax.legend()
plt.show()






```

### Task 9

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)", linewidth=3)
ax.plot(x, yp, label="p'(x)", linewidth=1)

 # Inflection point
ax.scatter([x0], [y0])
ax.annotate(
    f"Inflection\n({x0:.2f},{y0:.2f})",
    xy=(x0, y0),
)

# Extrema
x1, x2 = -1.0, 1.0
y1, y2 = p(x1), p(x2)

ax.scatter([x1, x2], [y1, y2])
ax.annotate(
    f"Local max\n({x1:.2f},{y1:.2f})",
    xy=(x1, y1),
)
ax.annotate(
    f"Local min\n({x2:.2f},{y2:.2f})",
    xy=(x2, y2),
)

ax.legend()
plt.show()
```

### Task 10

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)", linewidth=3)
ax.plot(x, yp, label="p'(x)", linewidth=1)
ax.set_title("Cubic polynomial and its derivative")
ax.legend()


 # Inflection point
ax.scatter([x0], [y0])
ax.annotate(
    f"Inflection\n({x0:.2f},{y0:.2f})",
    xy=(x0, y0),
)

# Extrema
x1, x2 = -1.0, 1.0
y1, y2 = p(x1), p(x2)

ax.scatter([x1, x2], [y1, y2])
ax.annotate(
    f"Local max\n({x1:.2f},{y1:.2f})",
    xy=(x1, y1),
)
ax.annotate(
    f"Local min\n({x2:.2f},{y2:.2f})",
    xy=(x2, y2),
)

plt.show()
```

### Task 11

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)

fig, ax = plt.subplots()
ax.plot(x, y, label="p(x)", linewidth=3)
ax.plot(x, yp, label="p'(x)", linewidth=1)
ax.set_title("Cubic polynomial and its derivative")
ax.legend()


 # Inflection point
ax.scatter([x0], [y0])
ax.annotate(
    f"Inflection\n({x0:.2f},{y0:.2f})",
    xy=(x0, y0),
)

# Extrema
x1, x2 = -1.0, 1.0
y1, y2 = p(x1), p(x2)

ax.scatter([x1, x2], [y1, y2])
ax.annotate(
    f"Local max\n({x1:.2f},{y1:.2f})",
    xy=(x1, y1),
)
ax.annotate(
    f"Local min\n({x2:.2f},{y2:.2f})",
    xy=(x2, y2),
)

# This does not do anything in this notebook, but in a local Python
fig.savefig("sheet_11_polynomial.png", dpi=150)
plt.show()
```
