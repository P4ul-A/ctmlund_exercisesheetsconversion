---
title: "Sheet Eleven Solutions"
format: html
filters:
  - pyodide
---

### Task 3

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

plt.plot(x, y, label="p(x)")
plt.plot(x, yp, label="p'(x)")
plt.legend()
plt.show()
```

### Task 4

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

# Inflection point for this cubic is at x = 0.
x0 = 0.0
y0 = p(x0)
slope = dp(x0)

x_tan = np.linspace(x0 - 1.0, x0 + 1.0, 50)
y_tan = y0 + slope * (x_tan - x0)

plt.plot(x, y, label="p(x)")
plt.plot(x, yp, label="p'(x)")
plt.plot(x_tan, y_tan, label="Tangent at inflection")
plt.legend()
plt.show()
```

### Task 5

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

# Extrema at x = -1 and x = 1.
x1 = -1.0
x2 = 1.0
y1 = p(x1)
y2 = p(x2)

x_tan1 = np.linspace(x1 - 1.0, x1 + 1.0, 50)
x_tan2 = np.linspace(x2 - 1.0, x2 + 1.0, 50)
y_tan1 = y1 + 0.0 * (x_tan1 - x1)
y_tan2 = y2 + 0.0 * (x_tan2 - x2)

plt.plot(x, y, label="p(x)")
plt.plot(x, yp, label="p'(x)")
plt.plot(x_tan1, y_tan1, label="Tangent at x=-1")
plt.plot(x_tan2, y_tan2, label="Tangent at x=1")
plt.legend()
plt.show()
```

### Task 6

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)
slope = dp(x0)
x_tan = np.linspace(x0 - 1.0, x0 + 1.0, 50)
y_tan = y0 + slope * (x_tan - x0)

plt.plot(x, y, label="p(x)")
plt.plot(x, yp, label="p'(x)")
plt.plot(x_tan, y_tan, color="black", linestyle=":", label="Tangent")
plt.legend()
plt.show()
```

### Task 7

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

plt.plot(x, y, label="p(x)", linewidth=3)
plt.plot(x, yp, label="p'(x)", linewidth=1)
plt.legend()
plt.show()
```

### Task 8

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
y0 = p(x0)

plt.plot(x, y, label="p(x)", linewidth=3)
plt.plot(x, yp, label="p'(x)", linewidth=1)
plt.annotate("Inflection", xy=(x0, y0), xytext=(0.5, 2.0))
plt.legend()
plt.show()
```

### Task 9

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

x0 = 0.0
x1 = -1.0
x2 = 1.0
y0 = p(x0)
y1 = p(x1)
y2 = p(x2)

plt.plot(x, y, label="p(x)", linewidth=3)
plt.plot(x, yp, label="p'(x)", linewidth=1)

plt.xticks([x1, x0, x2])
plt.yticks([y1, y0, y2])

plt.legend()
plt.show()
```

### Task 10

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

plt.plot(x, y, label="p(x)", linewidth=3)
plt.plot(x, yp, label="p'(x)", linewidth=1)
plt.title("Cubic polynomial and its derivative")
plt.legend()
plt.show()
```

### Task 11

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def p(x):
    return x**3 - 3 * x

def dp(x):
    return 3 * x**2 - 3

x = np.linspace(-3.0, 3.0, 400)
y = p(x)
yp = dp(x)

plt.plot(x, y, label="p(x)", linewidth=3)
plt.plot(x, yp, label="p'(x)", linewidth=1)
plt.title("Cubic polynomial and its derivative")
plt.legend()

plt.savefig("sheet_11_polynomial.png", dpi=150)
plt.show()
```
