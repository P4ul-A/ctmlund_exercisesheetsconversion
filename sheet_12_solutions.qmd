---
title: "Sheet Twelve Solutions"
format: html
filters:
  - pyodide
---

### Task 1

Axes demo: <https://matplotlib.org/stable/gallery/subplots_axes_and_figures/axes_demo.html>.  


```{pyodide-python}
#| read-only: false

import matplotlib.pyplot as plt
import numpy as np

np.random.seed(69)  # Fixing random state for reproducibility.

# create some data to use for the plot
dt = 0.001
t = np.arange(0.0, 10.0, dt)
r = np.exp(-t[:1000] / 0.05)  # impulse response
x = np.random.randn(len(t))
s = np.convolve(x, r)[:len(x)] * dt  # colored noise

fig, main_ax = plt.subplots()
main_ax.plot(t, s)
main_ax.set_xlim(0, 1)
main_ax.set_ylim(1.1 * np.min(s), 2 * np.max(s))
main_ax.set_xlabel('time (s)')
main_ax.set_ylabel('current (nA)')
main_ax.set_title('Gaussian colored noise')

# this is an inset Axes over the main Axes
right_inset_ax = fig.add_axes([.65, .6, .2, .2], facecolor='k')
right_inset_ax.hist(s, 400, density=True)
right_inset_ax.set(title='Probability', xticks=[], yticks=[])

# this is another inset Axes over the main Axes
left_inset_ax = fig.add_axes([.2, .6, .2, .2], facecolor='k')
left_inset_ax.plot(t[:len(r)], r)
left_inset_ax.set(title='Impulse response', xlim=(0, .2), xticks=[], yticks=[])

plt.show()

```

### Task 2

```{pyodide-python}
#| read-only: false
# TODO: obtain and run a 3D plotting example from the book.
```


### Task 3

```{pyodide-python}
#| read-only: false
import numpy as np
import matplotlib.pyplot as plt

def taylor_sin(x, x0, omega):
    """Second degree Taylor polynomial of sin(omega x) about x0."""
    f0 = np.sin(omega * x0)
    f1 = omega * np.cos(omega * x0)
    f2 = -omega**2 * np.sin(omega * x0)
    dx = x - x0
    return f0 + f1 * dx + 0.5 * f2 * dx**2

x0 = 0.5
omega = 2.0

x = np.linspace(0.0, 2.0 * np.pi, 400)
y = np.sin(omega * x)
yt = taylor_sin(x, x0, omega)

fig, ax = plt.subplots()
ax.plot(x, y, label="sin(omega x)", linewidth=2)
ax.plot(x, yt, label="Taylor polynomial", linestyle="--")
ax.legend()
plt.show()
```

### Task 4

```{pyodide-python}
#| read-only: false
# Interactive plot does not work in this environment, 
# copy the code to your local machine to run it.
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.widgets import Slider

def taylor_sin(x, x0, omega):
    f0 = np.sin(omega * x0)
    f1 = omega * np.cos(omega * x0)
    f2 = -omega**2 * np.sin(omega * x0)
    dx = x - x0
    return f0 + f1 * dx + 0.5 * f2 * dx**2

x = np.linspace(0.0, 2.0 * np.pi, 400)
x0_init = 0.5
omega_init = 2.0

fig, ax = plt.subplots()
fig.subplots_adjust(bottom=0.25)

line_f, = ax.plot(x, np.sin(omega_init * x), label="sin(omega x)", linewidth=2)
line_t, = ax.plot(x, taylor_sin(x, x0_init, omega_init), label="Taylor", linestyle="--")
ax.legend()
ax.set_xlabel("x")
ax.set_ylabel("y")

ax_x0 = fig.add_axes([0.2, 0.1, 0.65, 0.03])
ax_omega = fig.add_axes([0.2, 0.05, 0.65, 0.03])

slider_x0 = Slider(ax_x0, "x0", 0.0, 2.0 * np.pi, valinit=x0_init)
slider_omega = Slider(ax_omega, "omega", 0.1, 6.0, valinit=omega_init)

def update(_):
    x0 = slider_x0.val
    omega = slider_omega.val
    line_f.set_ydata(np.sin(omega * x))
    line_t.set_ydata(taylor_sin(x, x0, omega))
    fig.canvas.draw_idle()

slider_x0.on_changed(update)
slider_omega.on_changed(update)

plt.show()
```
